package fleetserver

import (
	"encoding/json"
	"fmt"
	"testing"
)

func NewCheckinResponsePolicySystemIntegration(
	t *testing.T, agentID, ackToken string) CheckinResponse {

	resp := CheckinResponse{}
	err := json.Unmarshal(
		[]byte(fmt.Sprintf(checkinResponseJSONPolicySystemIntegration,
			ackToken, agentID)),
		&resp)
	if err != nil {
		t.Fatalf("could not unmarshal checkinResponseJSONPolicySystemIntegration: %v",
			err)
	}

	return resp
}

func NewCheckinResponsePolicySystemIntegrationAndEndpoint(
	t *testing.T, agentID, ackToken string) CheckinResponse {

	resp := CheckinResponse{}
	err := json.Unmarshal(
		[]byte(fmt.Sprintf(checkinResponseJSONPolicySystemIntegrationAndEndpoint,
			ackToken, agentID)),
		&resp)
	if err != nil {
		t.Fatalf("could not unmarshal checkinResponseJSONPolicySystemIntegrationAndEndpoint: %v",
			err)
	}

	return resp
}

const (
	checkinResponseJSONPolicySystemIntegration = `{"ack_token":"%s","action":"checkin","actions":[{"agent_id":"%s","created_at":"2023-05-31T11:37:50.607Z","data":{"policy":{"agent":{"download":{"sourceURI":"https://artifacts.elastic.co/downloads/"},"monitoring":{"namespace":"default","use_output":"default","enabled":true,"logs":true,"metrics":true},"features":{},"protection":{"enabled":false,"uninstall_token_hash":"lORSaDIQq4nglUMJwWjKrwexj4IDRJA+FtoQeeqKH/I=","signing_key":"MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEQ9BPoHUCyLyElVpfwvKeFdUt6U9wBb+QlZNf4cy5eAwK9Xh4D8fClgciPeRs3j62i6IEeGyvOs9U3+fElyUigg=="}},"fleet":{"hosts":["https://039f8e82bf51414bb159b622ca02b284.fleet.us-central1.gcp.qa.cld.elstc.co:443"]},"id":"24e4d030-ffa7-11ed-b040-9debaa5fecb8","inputs":[{"id":"logfile-system-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","revision":1,"name":"system-1","type":"logfile","data_stream":{"namespace":"default"},"use_output":"default","package_policy_id":"bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","streams":[{"id":"logfile-system.auth-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"logs","dataset":"system.auth"},"ignore_older":"72h","paths":["/var/log/auth.log*","/var/log/secure*"],"exclude_files":[".gz$"],"multiline":{"pattern":"^\\s","match":"after"},"tags":["system-auth"],"processors":[{"add_locale":null}]},{"id":"logfile-system.syslog-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"logs","dataset":"system.syslog"},"paths":["/var/log/messages*","/var/log/syslog*","/var/log/system*"],"exclude_files":[".gz$"],"multiline":{"pattern":"^\\s","match":"after"},"processors":[{"add_locale":null}],"ignore_older":"72h"}],"meta":{"package":{"name":"system","version":"1.29.0"}}},{"id":"winlog-system-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","revision":1,"name":"system-1","type":"winlog","data_stream":{"namespace":"default"},"use_output":"default","package_policy_id":"bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","streams":[{"id":"winlog-system.application-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"logs","dataset":"system.application"},"name":"Application","condition":"${host.platform} == 'windows'","ignore_older":"72h"},{"id":"winlog-system.security-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"logs","dataset":"system.security"},"name":"Security","condition":"${host.platform} == 'windows'","ignore_older":"72h"},{"id":"winlog-system.system-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"logs","dataset":"system.system"},"name":"System","condition":"${host.platform} == 'windows'","ignore_older":"72h"}],"meta":{"package":{"name":"system","version":"1.29.0"}}},{"id":"system/metrics-system-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","revision":1,"name":"system-1","type":"system/metrics","data_stream":{"namespace":"default"},"use_output":"default","package_policy_id":"bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","streams":[{"id":"system/metrics-system.cpu-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.cpu"},"metricsets":["cpu"],"cpu.metrics":["percentages","normalized_percentages"],"period":"10s"},{"id":"system/metrics-system.diskio-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.diskio"},"metricsets":["diskio"],"diskio.include_devices":null,"period":"10s"},{"id":"system/metrics-system.filesystem-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.filesystem"},"metricsets":["filesystem"],"period":"1m","processors":[{"drop_event.when.regexp":{"system.filesystem.mount_point":"^/(sys|cgroup|proc|dev|etc|host|lib|snap)($|/)"}}]},{"id":"system/metrics-system.fsstat-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.fsstat"},"metricsets":["fsstat"],"period":"1m","processors":[{"drop_event.when.regexp":{"system.fsstat.mount_point":"^/(sys|cgroup|proc|dev|etc|host|lib|snap)($|/)"}}]},{"id":"system/metrics-system.load-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.load"},"metricsets":["load"],"condition":"${host.platform} != 'windows'","period":"10s"},{"id":"system/metrics-system.memory-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.memory"},"metricsets":["memory"],"period":"10s"},{"id":"system/metrics-system.network-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.network"},"metricsets":["network"],"period":"10s","network.interfaces":null},{"id":"system/metrics-system.process-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.process"},"metricsets":["process"],"period":"10s","process.include_top_n.by_cpu":5,"process.include_top_n.by_memory":5,"process.cmdline.cache.enabled":true,"process.cgroups.enabled":false,"process.include_cpu_ticks":false,"processes":[".*"]},{"id":"system/metrics-system.process.summary-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.process.summary"},"metricsets":["process_summary"],"period":"10s"},{"id":"system/metrics-system.socket_summary-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.socket_summary"},"metricsets":["socket_summary"],"period":"10s"},{"id":"system/metrics-system.uptime-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.uptime"},"metricsets":["uptime"],"period":"10s"}],"meta":{"package":{"name":"system","version":"1.29.0"}}}],"output_permissions":{"default":{"_elastic_agent_monitoring":{"indices":[{"names":["logs-elastic_agent.apm_server-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.apm_server-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.auditbeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.auditbeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.cloud_defend-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.cloudbeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.cloudbeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.elastic_agent-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.endpoint_security-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.endpoint_security-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.filebeat_input-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.filebeat_input-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.filebeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.filebeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.fleet_server-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.fleet_server-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.heartbeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.heartbeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.metricbeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.metricbeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.osquerybeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.osquerybeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.packetbeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.packetbeat-default"],"privileges":["auto_configure","create_doc"]}]},"_elastic_agent_checks":{"cluster":["monitor"]},"bedf2f42-a252-40bb-ab2b-8a7e1b874c7a":{"indices":[{"names":["logs-system.auth-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-system.syslog-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-system.application-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-system.security-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-system.system-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.cpu-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.diskio-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.filesystem-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.fsstat-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.load-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.memory-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.network-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.process-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.process.summary-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.socket_summary-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.uptime-default"],"privileges":["auto_configure","create_doc"]}]}}},"outputs":{"default":{"api_key":"9fGrcYgBX6JHv-JteDYm:fErCEKVWQhuZedzb5ldYOQ","hosts":["https://743815b87bcf40e0b093b28ab0e131bb.us-central1.gcp.qa.cld.elstc.co:443"],"type":"elasticsearch"}},"revision":2,"secret_references":[],"signed":{"data":"eyJpZCI6IjI0ZTRkMDMwLWZmYTctMTFlZC1iMDQwLTlkZWJhYTVmZWNiOCIsImFnZW50Ijp7InByb3RlY3Rpb24iOnsiZW5hYmxlZCI6ZmFsc2UsInVuaW5zdGFsbF90b2tlbl9oYXNoIjoibE9SU2FESVFxNG5nbFVNSndXaktyd2V4ajRJRFJKQStGdG9RZWVxS0gvST0iLCJzaWduaW5nX2tleSI6Ik1Ga3dFd1lIS29aSXpqMENBUVlJS29aSXpqMERBUWNEUWdBRVE5QlBvSFVDeUx5RWxWcGZ3dktlRmRVdDZVOXdCYitRbFpOZjRjeTVlQXdLOVhoNEQ4ZkNsZ2NpUGVSczNqNjJpNklFZUd5dk9zOVUzK2ZFbHlVaWdnPT0ifX19","signature":"MEUCIQCfS6wPj/AvfFA79dwKATnvyFl/ZeyA8eKOLHg1XuA9NgIgNdhjIT+G/GZFqsVoWk5jThONhpqPhfiHLE5OkTdrwT0="}}},"id":"policy:24e4d030-ffa7-11ed-b040-9debaa5fecb8:2:1","input_type":"","type":"POLICY_CHANGE"}]}`

	checkinResponseJSONPolicySystemIntegrationAndEndpoint = `{"ack_token":"%s","action":"checkin","actions":[{"agent_id":"%s","created_at":"2023-05-31T12:02:42.851Z","data":{"policy":{"agent":{"download":{"sourceURI":"https://artifacts.elastic.co/downloads/"},"monitoring":{"namespace":"default","use_output":"default","enabled":true,"logs":true,"metrics":true},"features":{},"protection":{"enabled":false,"uninstall_token_hash":"lORSaDIQq4nglUMJwWjKrwexj4IDRJA+FtoQeeqKH/I=","signing_key":"MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEQ9BPoHUCyLyElVpfwvKeFdUt6U9wBb+QlZNf4cy5eAwK9Xh4D8fClgciPeRs3j62i6IEeGyvOs9U3+fElyUigg=="}},"fleet":{"hosts":["https://039f8e82bf51414bb159b622ca02b284.fleet.us-central1.gcp.qa.cld.elstc.co:443"]},"id":"24e4d030-ffa7-11ed-b040-9debaa5fecb8","inputs":[{"id":"logfile-system-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","revision":1,"name":"system-1","type":"logfile","data_stream":{"namespace":"default"},"use_output":"default","package_policy_id":"bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","streams":[{"id":"logfile-system.auth-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"logs","dataset":"system.auth"},"ignore_older":"72h","paths":["/var/log/auth.log*","/var/log/secure*"],"exclude_files":[".gz$"],"multiline":{"pattern":"^\\s","match":"after"},"tags":["system-auth"],"processors":[{"add_locale":null}]},{"id":"logfile-system.syslog-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"logs","dataset":"system.syslog"},"paths":["/var/log/messages*","/var/log/syslog*","/var/log/system*"],"exclude_files":[".gz$"],"multiline":{"pattern":"^\\s","match":"after"},"processors":[{"add_locale":null}],"ignore_older":"72h"}],"meta":{"package":{"name":"system","version":"1.29.0"}}},{"id":"winlog-system-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","revision":1,"name":"system-1","type":"winlog","data_stream":{"namespace":"default"},"use_output":"default","package_policy_id":"bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","streams":[{"id":"winlog-system.application-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"logs","dataset":"system.application"},"name":"Application","condition":"${host.platform} == 'windows'","ignore_older":"72h"},{"id":"winlog-system.security-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"logs","dataset":"system.security"},"name":"Security","condition":"${host.platform} == 'windows'","ignore_older":"72h"},{"id":"winlog-system.system-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"logs","dataset":"system.system"},"name":"System","condition":"${host.platform} == 'windows'","ignore_older":"72h"}],"meta":{"package":{"name":"system","version":"1.29.0"}}},{"id":"system/metrics-system-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","revision":1,"name":"system-1","type":"system/metrics","data_stream":{"namespace":"default"},"use_output":"default","package_policy_id":"bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","streams":[{"id":"system/metrics-system.cpu-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.cpu"},"metricsets":["cpu"],"cpu.metrics":["percentages","normalized_percentages"],"period":"10s"},{"id":"system/metrics-system.diskio-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.diskio"},"metricsets":["diskio"],"diskio.include_devices":null,"period":"10s"},{"id":"system/metrics-system.filesystem-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.filesystem"},"metricsets":["filesystem"],"period":"1m","processors":[{"drop_event.when.regexp":{"system.filesystem.mount_point":"^/(sys|cgroup|proc|dev|etc|host|lib|snap)($|/)"}}]},{"id":"system/metrics-system.fsstat-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.fsstat"},"metricsets":["fsstat"],"period":"1m","processors":[{"drop_event.when.regexp":{"system.fsstat.mount_point":"^/(sys|cgroup|proc|dev|etc|host|lib|snap)($|/)"}}]},{"id":"system/metrics-system.load-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.load"},"metricsets":["load"],"condition":"${host.platform} != 'windows'","period":"10s"},{"id":"system/metrics-system.memory-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.memory"},"metricsets":["memory"],"period":"10s"},{"id":"system/metrics-system.network-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.network"},"metricsets":["network"],"period":"10s","network.interfaces":null},{"id":"system/metrics-system.process-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.process"},"metricsets":["process"],"period":"10s","process.include_top_n.by_cpu":5,"process.include_top_n.by_memory":5,"process.cmdline.cache.enabled":true,"process.cgroups.enabled":false,"process.include_cpu_ticks":false,"processes":[".*"]},{"id":"system/metrics-system.process.summary-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.process.summary"},"metricsets":["process_summary"],"period":"10s"},{"id":"system/metrics-system.socket_summary-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.socket_summary"},"metricsets":["socket_summary"],"period":"10s"},{"id":"system/metrics-system.uptime-bedf2f42-a252-40bb-ab2b-8a7e1b874c7a","data_stream":{"type":"metrics","dataset":"system.uptime"},"metricsets":["uptime"],"period":"10s"}],"meta":{"package":{"name":"system","version":"1.29.0"}}},{"id":"c591944e-c2dc-4035-ade3-f2233d59c913","revision":1,"name":"sec-1","type":"endpoint","data_stream":{"namespace":"default"},"use_output":"default","package_policy_id":"c591944e-c2dc-4035-ade3-f2233d59c913","integration_config":{"type":"endpoint","endpointConfig":{"preset":"EDRComplete"}},"artifact_manifest":{"manifest_version":"1.0.0","schema_version":"v1","artifacts":{"endpoint-exceptionlist-macos-v1":{"encryption_algorithm":"none","decoded_sha256":"d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","decoded_size":14,"encoded_sha256":"f8e6afa1d5662f5b37f83337af774b5785b5b7f1daee08b7b00c2d6813874cda","encoded_size":22,"relative_url":"/api/fleet/artifacts/endpoint-exceptionlist-macos-v1/d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","compression_algorithm":"zlib"},"endpoint-exceptionlist-windows-v1":{"encryption_algorithm":"none","decoded_sha256":"d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","decoded_size":14,"encoded_sha256":"f8e6afa1d5662f5b37f83337af774b5785b5b7f1daee08b7b00c2d6813874cda","encoded_size":22,"relative_url":"/api/fleet/artifacts/endpoint-exceptionlist-windows-v1/d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","compression_algorithm":"zlib"},"endpoint-exceptionlist-linux-v1":{"encryption_algorithm":"none","decoded_sha256":"d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","decoded_size":14,"encoded_sha256":"f8e6afa1d5662f5b37f83337af774b5785b5b7f1daee08b7b00c2d6813874cda","encoded_size":22,"relative_url":"/api/fleet/artifacts/endpoint-exceptionlist-linux-v1/d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","compression_algorithm":"zlib"},"endpoint-trustlist-macos-v1":{"encryption_algorithm":"none","decoded_sha256":"d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","decoded_size":14,"encoded_sha256":"f8e6afa1d5662f5b37f83337af774b5785b5b7f1daee08b7b00c2d6813874cda","encoded_size":22,"relative_url":"/api/fleet/artifacts/endpoint-trustlist-macos-v1/d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","compression_algorithm":"zlib"},"endpoint-trustlist-windows-v1":{"encryption_algorithm":"none","decoded_sha256":"d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","decoded_size":14,"encoded_sha256":"f8e6afa1d5662f5b37f83337af774b5785b5b7f1daee08b7b00c2d6813874cda","encoded_size":22,"relative_url":"/api/fleet/artifacts/endpoint-trustlist-windows-v1/d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","compression_algorithm":"zlib"},"endpoint-trustlist-linux-v1":{"encryption_algorithm":"none","decoded_sha256":"d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","decoded_size":14,"encoded_sha256":"f8e6afa1d5662f5b37f83337af774b5785b5b7f1daee08b7b00c2d6813874cda","encoded_size":22,"relative_url":"/api/fleet/artifacts/endpoint-trustlist-linux-v1/d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","compression_algorithm":"zlib"},"endpoint-eventfilterlist-macos-v1":{"encryption_algorithm":"none","decoded_sha256":"d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","decoded_size":14,"encoded_sha256":"f8e6afa1d5662f5b37f83337af774b5785b5b7f1daee08b7b00c2d6813874cda","encoded_size":22,"relative_url":"/api/fleet/artifacts/endpoint-eventfilterlist-macos-v1/d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","compression_algorithm":"zlib"},"endpoint-eventfilterlist-windows-v1":{"encryption_algorithm":"none","decoded_sha256":"d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","decoded_size":14,"encoded_sha256":"f8e6afa1d5662f5b37f83337af774b5785b5b7f1daee08b7b00c2d6813874cda","encoded_size":22,"relative_url":"/api/fleet/artifacts/endpoint-eventfilterlist-windows-v1/d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","compression_algorithm":"zlib"},"endpoint-eventfilterlist-linux-v1":{"encryption_algorithm":"none","decoded_sha256":"d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","decoded_size":14,"encoded_sha256":"f8e6afa1d5662f5b37f83337af774b5785b5b7f1daee08b7b00c2d6813874cda","encoded_size":22,"relative_url":"/api/fleet/artifacts/endpoint-eventfilterlist-linux-v1/d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","compression_algorithm":"zlib"},"endpoint-hostisolationexceptionlist-macos-v1":{"encryption_algorithm":"none","decoded_sha256":"d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","decoded_size":14,"encoded_sha256":"f8e6afa1d5662f5b37f83337af774b5785b5b7f1daee08b7b00c2d6813874cda","encoded_size":22,"relative_url":"/api/fleet/artifacts/endpoint-hostisolationexceptionlist-macos-v1/d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","compression_algorithm":"zlib"},"endpoint-hostisolationexceptionlist-windows-v1":{"encryption_algorithm":"none","decoded_sha256":"d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","decoded_size":14,"encoded_sha256":"f8e6afa1d5662f5b37f83337af774b5785b5b7f1daee08b7b00c2d6813874cda","encoded_size":22,"relative_url":"/api/fleet/artifacts/endpoint-hostisolationexceptionlist-windows-v1/d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","compression_algorithm":"zlib"},"endpoint-hostisolationexceptionlist-linux-v1":{"encryption_algorithm":"none","decoded_sha256":"d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","decoded_size":14,"encoded_sha256":"f8e6afa1d5662f5b37f83337af774b5785b5b7f1daee08b7b00c2d6813874cda","encoded_size":22,"relative_url":"/api/fleet/artifacts/endpoint-hostisolationexceptionlist-linux-v1/d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","compression_algorithm":"zlib"},"endpoint-blocklist-macos-v1":{"encryption_algorithm":"none","decoded_sha256":"d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","decoded_size":14,"encoded_sha256":"f8e6afa1d5662f5b37f83337af774b5785b5b7f1daee08b7b00c2d6813874cda","encoded_size":22,"relative_url":"/api/fleet/artifacts/endpoint-blocklist-macos-v1/d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","compression_algorithm":"zlib"},"endpoint-blocklist-windows-v1":{"encryption_algorithm":"none","decoded_sha256":"d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","decoded_size":14,"encoded_sha256":"f8e6afa1d5662f5b37f83337af774b5785b5b7f1daee08b7b00c2d6813874cda","encoded_size":22,"relative_url":"/api/fleet/artifacts/endpoint-blocklist-windows-v1/d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","compression_algorithm":"zlib"},"endpoint-blocklist-linux-v1":{"encryption_algorithm":"none","decoded_sha256":"d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","decoded_size":14,"encoded_sha256":"f8e6afa1d5662f5b37f83337af774b5785b5b7f1daee08b7b00c2d6813874cda","encoded_size":22,"relative_url":"/api/fleet/artifacts/endpoint-blocklist-linux-v1/d801aa1fb7ddcc330a5e3173372ea6af4a3d08ec58074478e85aa5603e926658","compression_algorithm":"zlib"}}},"policy":{"meta":{"license":"trial","cloud":true},"windows":{"events":{"credential_access":true,"dll_and_driver_load":true,"dns":true,"file":true,"network":true,"process":true,"registry":true,"security":true},"malware":{"mode":"prevent","blocklist":true},"ransomware":{"mode":"prevent","supported":true},"memory_protection":{"mode":"prevent","supported":true},"behavior_protection":{"mode":"prevent","supported":true},"popup":{"malware":{"message":"","enabled":true},"ransomware":{"message":"","enabled":true},"memory_protection":{"message":"","enabled":true},"behavior_protection":{"message":"","enabled":true}},"logging":{"file":"info"},"antivirus_registration":{"enabled":false},"attack_surface_reduction":{"credential_hardening":{"enabled":true}}},"mac":{"events":{"process":true,"file":true,"network":true},"malware":{"mode":"prevent","blocklist":true},"behavior_protection":{"mode":"prevent","supported":true},"memory_protection":{"mode":"prevent","supported":true},"popup":{"malware":{"message":"","enabled":true},"behavior_protection":{"message":"","enabled":true},"memory_protection":{"message":"","enabled":true}},"logging":{"file":"info"},"advanced":{"capture_env_vars":"DYLD_INSERT_LIBRARIES,DYLD_FRAMEWORK_PATH,DYLD_LIBRARY_PATH,LD_PRELOAD"}},"linux":{"events":{"process":true,"file":true,"network":true,"session_data":false,"tty_io":false},"malware":{"mode":"prevent","blocklist":true},"behavior_protection":{"mode":"prevent","supported":true},"memory_protection":{"mode":"prevent","supported":true},"popup":{"malware":{"message":"","enabled":true},"behavior_protection":{"message":"","enabled":true},"memory_protection":{"message":"","enabled":true}},"logging":{"file":"info"},"advanced":{"capture_env_vars":"LD_PRELOAD,LD_LIBRARY_PATH"}}},"meta":{"package":{"name":"endpoint","version":"8.8.0"}}}],"output_permissions":{"default":{"_elastic_agent_monitoring":{"indices":[{"names":["logs-elastic_agent.apm_server-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.apm_server-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.auditbeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.auditbeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.cloud_defend-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.cloudbeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.cloudbeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.elastic_agent-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.endpoint_security-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.endpoint_security-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.filebeat_input-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.filebeat_input-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.filebeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.filebeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.fleet_server-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.fleet_server-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.heartbeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.heartbeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.metricbeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.metricbeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.osquerybeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.osquerybeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-elastic_agent.packetbeat-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-elastic_agent.packetbeat-default"],"privileges":["auto_configure","create_doc"]}]},"_elastic_agent_checks":{"cluster":["monitor"]},"bedf2f42-a252-40bb-ab2b-8a7e1b874c7a":{"indices":[{"names":["logs-system.auth-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-system.syslog-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-system.application-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-system.security-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-system.system-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.cpu-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.diskio-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.filesystem-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.fsstat-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.load-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.memory-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.network-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.process-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.process.summary-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.socket_summary-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-system.uptime-default"],"privileges":["auto_configure","create_doc"]}]},"c591944e-c2dc-4035-ade3-f2233d59c913":{"indices":[{"names":[".logs-endpoint.action.responses-default"],"privileges":["auto_configure","create_doc"]},{"names":[".logs-endpoint.actions-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-endpoint.alerts-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-endpoint.events.api-default"],"privileges":["auto_configure","create_doc"]},{"names":[".logs-endpoint.diagnostic.collection-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-endpoint.events.file-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-endpoint.events.library-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-endpoint.metadata-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-endpoint.metrics-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-endpoint.events.network-default"],"privileges":["auto_configure","create_doc"]},{"names":["metrics-endpoint.policy-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-endpoint.events.process-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-endpoint.events.registry-default"],"privileges":["auto_configure","create_doc"]},{"names":["logs-endpoint.events.security-default"],"privileges":["auto_configure","create_doc"]}]}}},"outputs":{"default":{"api_key":"9fGrcYgBX6JHv-JteDYm:fErCEKVWQhuZedzb5ldYOQ","hosts":["https://743815b87bcf40e0b093b28ab0e131bb.us-central1.gcp.qa.cld.elstc.co:443"],"type":"elasticsearch"}},"revision":3,"secret_references":[],"signed":{"data":"eyJpZCI6IjI0ZTRkMDMwLWZmYTctMTFlZC1iMDQwLTlkZWJhYTVmZWNiOCIsImFnZW50Ijp7InByb3RlY3Rpb24iOnsiZW5hYmxlZCI6ZmFsc2UsInVuaW5zdGFsbF90b2tlbl9oYXNoIjoibE9SU2FESVFxNG5nbFVNSndXaktyd2V4ajRJRFJKQStGdG9RZWVxS0gvST0iLCJzaWduaW5nX2tleSI6Ik1Ga3dFd1lIS29aSXpqMENBUVlJS29aSXpqMERBUWNEUWdBRVE5QlBvSFVDeUx5RWxWcGZ3dktlRmRVdDZVOXdCYitRbFpOZjRjeTVlQXdLOVhoNEQ4ZkNsZ2NpUGVSczNqNjJpNklFZUd5dk9zOVUzK2ZFbHlVaWdnPT0ifX19","signature":"MEYCIQCctIP+nVRrWGD5aACU3OB++2IVgtGkSQLgkxj6HVlyBAIhAMSrSpj+Gn4dLkZE9mMSI06+3hWhjdW0eiK3pwYFWqnI"}}},"id":"policy:24e4d030-ffa7-11ed-b040-9debaa5fecb8:3:1","input_type":"","type":"POLICY_CHANGE"}]}`
)
