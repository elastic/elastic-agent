inputs:
    - name: cloudbeat/cis_k8s-cloud_security_posture
      type: cloudbeat/cis_k8s
      use_output: default
      streams:
        - condition: ${kubernetes.hints.cloud_security_posture.findings.enabled} == true or ${kubernetes.hints.cloud_security_posture.enabled} == true
          data_stream:
            dataset: cloud_security_posture.findings
            type: logs
          evaluator:
            decision_logs: false
          fetchers:
            - name: kube-api
            - directory: /hostfs
              name: process
              processes:
                etcd: null
                kube-apiserver: null
                kube-controller: null
                kube-scheduler: null
                kubelet:
                    config-file-arguments:
                        - config
            - name: file-system
              patterns:
                - /hostfs/etc/kubernetes/scheduler.conf
                - /hostfs/etc/kubernetes/controller-manager.conf
                - /hostfs/etc/kubernetes/admin.conf
                - /hostfs/etc/kubernetes/kubelet.conf
                - /hostfs/etc/kubernetes/manifests/etcd.yaml
                - /hostfs/etc/kubernetes/manifests/kube-apiserver.yaml
                - /hostfs/etc/kubernetes/manifests/kube-controller-manager.yaml
                - /hostfs/etc/kubernetes/manifests/kube-scheduler.yaml
                - /hostfs/etc/systemd/system/kubelet.service.d/10-kubeadm.conf
                - /hostfs/etc/kubernetes/pki/*
                - /hostfs/var/lib/kubelet/config.yaml
                - /hostfs/var/lib/etcd
                - /hostfs/etc/kubernetes/pki
          name: Findings
          period: 4h
          processors:
            - add_cluster_id: null
      data_stream.namespace: default
    - name: cloudbeat/cis_eks-cloud_security_posture
      type: cloudbeat/cis_eks
      use_output: default
      streams:
        - condition: ${kubernetes.hints.cloud_security_posture.findings.enabled} == true and ${kubernetes.hints.cloud_security_posture.enabled} == true
          data_stream:
            dataset: cloud_security_posture.findings
            type: logs
          evaluator:
            decision_logs: false
          fetchers:
            - name: kube-api
            - directory: /hostfs
              name: process
              processes:
                kubelet:
                    config-file-arguments:
                        - config
            - name: aws-ecr
            - name: aws-elb
            - name: file-system
              patterns:
                - /hostfs/etc/kubernetes/kubelet/kubelet-config.json
                - /hostfs/var/lib/kubelet/kubeconfig
          name: Findings
          period: 4h
          processors:
            - add_cluster_id: null
      data_stream.namespace: default
    - name: filestream-cloud_security_posture
      type: filestream
      use_output: default
      streams:
        - condition: ${kubernetes.hints.cloud_security_posture.container_logs.enabled} == true
          data_stream:
            dataset: kubernetes.container_logs
            type: logs
          exclude_files: []
          exclude_lines: []
          parsers:
            - container:
                format: auto
                stream: all
          paths:
            - /var/log/containers/*${kubernetes.hints.container_id}.log
          prospector:
            scanner:
                symlinks: true
          tags: []
      data_stream.namespace: default
